<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>课程评分</title>
		<link rel="stylesheet" href="../lib/layui-v2.6.3/css/layui.css">
		<style>
			.required::before {
				content: "*";
				color: #ff0000;
				margin-right: 4px;
				font-weight: bold;				
			}
		</style>
	</head>
	<body>
		<fieldset class="layui-elem-field layui-field-title">
			<legend style="font-weight: bold;">课程评分</legend>
		</fieldset>
		<div class="layui-form" lay-filter="courseForm">
			<div class="layui-form-item">
				<label class="layui-form-label required">课程名称</label>
				<div class="layui-input-block">
					<input id="username" type="text" name="username" class="layui-input" lay-verify="required"
						lay-reqtext="课程名称不能为空!" placeholder="请输入课程名称">
				</div>
			</div>
			
			<div class="layui-form-item">
				<label class="layui-form-label required">课程讲师</label>
				<div class="layui-input-block">
					<input id="teacher" type="text" name="teacher" class="layui-input" lay-verify="required"
						lay-reqtext="讲师名不能为空!" placeholder="请输入讲师名">
				</div>
			</div>
			
			<div class="layui-item">
				<label class="layui-form-label required" >讲师认真负责程度</label>
				<div id="ID-rate"></div>
			</div><br>
			
			<div class="layui-item">
				<label class="layui-form-label required" >讲师耐心解答程度</label>
				<div id="ID-rate2"></div>
			</div><br>
			
			<div class="layui-item">
				<label class="layui-form-label required" >讲师操作熟练程度</label>
				<div id="ID-rate3"></div>
			</div><br>
			
			<div class="layui-item">
				<label class="layui-form-label required" >讲师方法指导程度</label>
				<div id="ID-rate4"></div>
			</div><br>
			
			<div class="layui-item">
				<label class="layui-form-label required" >讲师总体评价</label>
				<div id="ID-rate6"></div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">教师建议</label>
				<div class="layui-input-block">
					<textarea name="remark" class="layui-textarea" placeholder="请输入给教师的建议（可选）"></textarea>
				</div>
			</div> 
			
			<!-- 提交按钮 -->
			<div class="layui-form-item">
				<div class="layui-input-block">
					<button class="layui-btn layui-btn-normal" lay-submit lay-filter="saveBtn">确认保存</button>
				</div>
			</div>
		</div>	
		<script src="../lib/layui-v2.6.3/layui.js"></script>
		<script>
		layui.use(function(){
		  var rate = layui.rate;
		  // 渲染
		  rate.render({
			elem: '#ID-rate',
			half: true,  // 开启半星
			text: true,
			theme: '#FF8000'
		  });
		});
		
		layui.use(function(){
		  var rate = layui.rate;
		  // 渲染
		  rate.render({
			elem: '#ID-rate2',
			half: true,
			text: true,
			theme: '#d0d0ff'
		  });
		});
		
		layui.use(function(){
		  var rate = layui.rate;
		  // 渲染
		  rate.render({
			elem: '#ID-rate3',
			half: true,
			text: true,
			theme: '#ffabf1'
		  });
		});
		
		layui.use(function(){
		  var rate = layui.rate;
		  // 渲染
		  rate.render({
			elem: '#ID-rate4',
			half: true,
			text: true,
			theme: '#d4d2ff'
		  });
		});
		
		layui.use(function(){
		  var rate = layui.rate;
		  // 渲染
		  rate.render({
			elem: '#ID-rate5',
			half: true,
			text: true,
			theme: '#a1fffc'
		  });
		});
		
		layui.use(function(){
		  var rate = layui.rate;
		  // 渲染
		  rate.render({
			elem: '#ID-rate6',
			half: true,
			text: true,
			theme: '#ff9dfe'
		  });
		});
		</script>
		<script>

			layui.use(['form', 'layer'], function() {
				var form = layui.form; 
				var layer = layui.layer; 
				$ = layui.$; 

				$("#username").blur(function() {
					var val = $(this).val().trim();
					var reg = /^[\u4e00-\u9fa5a-zA-Z]{2,10}$/;
					if (!val) {
						layer.msg('课程名称不能为空', {icon: 0, time: 1500});
					} else if (!reg.test(val)) {
						layer.msg('课程名称需为2-10位汉字/字母组合', {icon: 2, time: 1500});
					}
				});

				$("#teacher").blur(function() {
					var val = $(this).val().trim();
					var reg = /^[\u4e00-\u9fa5]{2,10}$/;
					if (!val) {
						layer.msg('讲师姓名不能为空', {icon: 0, time: 1500});
					} else if (!reg.test(val)) {
						layer.msg('讲师姓名需为2-10位汉字', {icon: 2, time: 1500});
					}
				});


				form.on('submit(saveBtn)', function(data) {
					var isValid = true;
					var errorMsg = '';

					var username = $("#username").val().trim();
					var usernameReg = /^[\u4e00-\u9fa5a-zA-Z]{2,10}$/;
					if (!username) {
						isValid = false;
						errorMsg = '课程名称不能为空';
					} else if (!usernameReg.test(username)) {
						isValid = false;
						errorMsg = '课程名称需为2-10位汉字/字母组合';
					}

					else if (!$("#teacher").val().trim()) {
						isValid = false;
						errorMsg = '讲师姓名不能为空';
					} else if (!/^[\u4e00-\u9fa5]{2,10}$/.test($("#teacher").val().trim())) {
						isValid = false;
						errorMsg = '讲师姓名需为2-10位汉字';
					}
					if (!isValid) {
						layer.msg(errorMsg, {icon: 0, time: 2000});
						return false; // 阻止表单提交
					}

					// 验证通过：显示提交信息（后续可对接AJAX提交到后端）
					var index = layer.alert(JSON.stringify(data.field, null, 2), {
						title: '课程提交信息确认',
						area: ['500px', '400px'],
						btn: ['确认提交', '取消'],
						yes: function() {
							// 此处可添加AJAX提交逻辑（示例）
							/*
							$.ajax({
								url: '你的课程添加接口地址',
								type: 'POST',
								data: data.field,
								dataType: 'json',
								success: function(res) {
									if (res.code === 0) {
										layer.msg('课程添加成功', {icon: 1, time: 1500}, function() {
											layer.close(index);
											// 关闭当前弹窗（若为iframe嵌套）
											var iframeIndex = parent.layer.getFrameIndex(window.name);
											parent.layer.close(iframeIndex);
											// 刷新父页面课程列表（可选）
											parent.location.reload();
										});
									} else {
										layer.msg(res.msg, {icon: 2});
									}
								},
								error: function() {
									layer.msg('网络错误，请重试', {icon: 2});
								}
							});
							*/
							// 测试用：仅关闭弹窗
							layer.close(index);
							var iframeIndex = parent.layer.getFrameIndex(window.name);
							parent.layer.close(iframeIndex);
						}
					});

					return false; // 阻止layui默认表单提交
				});
			});
		</script>
	</body>
</html>